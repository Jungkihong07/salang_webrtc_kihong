## 화상 통화 매칭 애플리케이션 요구 사항 및 기술 스택

### 🛠️ 주요 사용 기술 및 환경

- **P2P 연결 라이브러리:** **Trystero** (WebRTC 매치메이킹 및 시그널링 추상화)
- **시그널링/백엔드:** **Supabase** (Docker 기반 자가 호스팅, Realtime 기능 활용)
- **ICE 서버:** **coturn** (Docker 기반으로 구성하여 TURN/STUN 서버 인프라 확보)
- **프론트엔드:** **React + TypeScript + Vite**
- **개발 환경:** **Docker** 및 **Docker Compose**를 사용하여 전체 시스템 환경을 통일하여 구축 (개발 및 테스트 환경 간의 일관성 확보)

---

### 🟢 기능 요구 사항

1.  **1:1 랜덤 매칭:** 사용자는 무작위로 다른 사용자와 1:1 화상 통화 매칭을 시작할 수 있어야 합니다.
2.  **필터링 기능:** 매칭 시 다음과 같은 필터를 적용할 수 있어야 합니다.
    - 성별 필터링: 원하는 성별의 사용자에게만 매칭을 요청할 수 있어야 합니다.
3.  **매칭 세션 관리:**
    - 통화 연결이 성공하면, 두 사용자에게 고유한 세션(Room) ID가 할당되어야 합니다.
    - 통화가 정상적으로 종료되거나, 한쪽이 연결을 거절하면 해당 세션은 즉시 종료됩니다.

---

### 🟡 비기능 요구 사항

#### 안정적인 연결 관리

1.  통화 중 네트워크 일시 단절 발생 시, 5초 이내에 **Trystero를 활용**하여 자동으로 재연결을 시도해야 합니다.
2.  정상 종료, 타임아웃, 거절, 네트워크 종료 등 모든 통화 종료 원인을 구분하여 시스템에 기록해야 합니다.
3.  이전에 사용된 세션(Room) ID는 재사용할 수 없도록 관리해야 합니다.

#### 시스템 확장성

1.  사용자 수 증가에 대비하여, 동시 접속자 수가 많아져도 안정적으로 매칭 및 통화 세션을 처리할 수 있도록 시스템을 설계해야 합니다.
2.  **Docker Compose**를 활용하여 **API 게이트웨이, 매칭 서버, coturn (ICE) 서버** 등 모든 컴포넌트의 수평적 확장이 용이하도록 설계해야 합니다.

#### 보안

1.  사용자 프로필 정보와 결제 정보는 암호화하여 안전하게 관리해야 합니다.
2.  WebRTC의 기본 암호화(DTLS/SRTP) 외에, Supabase를 통한 데이터 교환 시 **RLS(Row Level Security)**를 적용해야 합니다.

#### 참고 문서

- [프로젝트 구조 설명](PROJECT_STRUCTURE.md)
